{"version":3,"file":null,"sources":["../src/qty-increment.ts"],"sourcesContent":["import $ from 'jquery';\n\n/**\n * component options interface.\n */\ninterface QtyIncrementOptions {\n    /**\n     * Namespace of the component. Default is 'cs-'\n     * @type {string}\n     */\n    namespace?: string;\n\n    /**\n     * Minimum input value that can be provided. Default is 1\n     * @type {number}\n     */\n    minValue?: number;\n\n    /**\n     * Maximum input value that can be provided. Default is 10\n     * @type {number}\n     */\n    maxValue?: number;\n\n    /**\n     * Error handler method for customization of the error presentation\n     * @type {() => void}\n     */\n    errorHandler?: () => void;\n}\n\nexport default class QtyIncrement {\n    protected _$element: JQuery;\n    protected _$container: JQuery;\n    protected _$input: JQuery;\n    protected _$decrementBtn: JQuery;\n    protected _$incrementBtn: JQuery;\n    protected _minValue: number;\n    protected _maxValue: number;\n    protected _eventListeners: {\n        clickListener?: ( $btn: JQuery ) => void;\n        keydownListener?: ( e: Event ) => void;\n        keyupListener?: () => void;\n        blurListener?: () => void;\n    } = {};\n    protected _errorHandler?: () => void;\n    protected _options: QtyIncrementOptions;\n\n    /**\n     * Creates new QtyIncrement component with optional settings.\n     * @param  {QtyIncrementOptions} options  Optional settings object.\n     */\n    public constructor( $element?: JQuery, options?: QtyIncrementOptions ) {\n        this._options           = $.extend( this._options, options );\n        this._options.namespace = this._options.namespace || 'cs-';\n\n        this._$container        = $element || $( `.${this._options.namespace}qty-increment` );\n        this._$input            = this._$container.find( `.${this._options.namespace}qty-increment__input` );\n        this._$decrementBtn     = this._$container.find( `.${this._options.namespace}qty-increment__button--decrement` );\n        this._$incrementBtn     = this._$container.find( `.${this._options.namespace}qty-increment__button--increment` );\n        this._minValue          = parseInt( this._$input.data( 'min-value' ) ) || 1;\n        this._maxValue          = parseInt( this._$input.data( 'max-value' ) ) || null;\n\n        this._errorHandler      = this._options.errorHandler || this._defaultErrorHandler;\n\n        this._attachEvents();\n        this._updateButtonsState();\n    }\n\n    /**\n     * Upddate button state (disable / enable)\n     */\n    protected _updateButtonsState(): void {\n        const currentValue: any = this._$input.val();\n\n        // If value of input is less than minimum, disable decrease button, otherwise, enable button\n        if ( currentValue <= this._minValue ) {\n            this._$container.find( $( `.${this._options.namespace}qty-increment__button--decrement` ) ).attr( 'disabled', 'disabled' ).addClass( `${this._options.namespace}qty-increment__button--disabled` );\n        } else {\n            this._$container.find( $( `.${this._options.namespace}qty-increment__button--decrement` ) ).removeAttr( 'disabled' ).removeClass( `${this._options.namespace}qty-increment__button--disabled` );\n        }\n\n        // If value of input is less than minimum, disable increase button, otherwise, enable button\n        if ( this._maxValue &&currentValue >= this._maxValue ) {\n            this._$container.find( $( `.${this._options.namespace}qty-increment__button--increment` ) ).attr( 'disabled', 'disabled' ).addClass( `${this._options.namespace}qty-increment__button--disabled` );\n        } else {\n            this._$container.find( $( `.${this._options.namespace}qty-increment__button--increment` ) ).removeAttr( 'disabled' ).removeClass( `${this._options.namespace}qty-increment__button--disabled` );\n        }\n    }\n\n    protected _defaultErrorHandler(): void {\n        if ( this._maxValue && parseFloat( this._$input.val() ) > this._maxValue ) {\n            alert( `The maximum value is ${this._maxValue}.` );\n        } else if ( parseFloat( this._$input.val() ) < this._minValue ) {\n            alert( `The minimum value is ${this._minValue}.` );\n        }\n    }\n\n    /**\n     * Shows error message and fixes value of input to min/max\n     */\n    protected _validate(): boolean {\n        let isValid: boolean = false;\n\n        if ( parseFloat( this._$input.val() ) < this._minValue || ( this._maxValue && parseFloat( this._$input.val() )  > this._maxValue ) ) {\n\n            // trigger errorHandler method to show error\n            this._errorHandler();\n\n            // Set minimum/maximum after error appeared\n            if ( ( this._maxValue && parseFloat( this._$input.val() )  > this._maxValue ) && parseFloat( this._$input.val() ) > this._maxValue ) {\n                this._$input.val( this._maxValue );\n            } else if ( parseFloat( this._$input.val() ) < this._minValue ) {\n                this._$input.val( this._minValue );\n            }\n\n            isValid = false;\n        } else {\n            $( document ).trigger( `.${this._options.namespace}qty-increment:change`, this._$input );\n            isValid = true;\n        }\n\n        return isValid;\n    }\n\n    /**\n     * Attaches events needed by component.\n     */\n    protected _attachEvents(): void {\n        const component: any = this;\n\n        this._eventListeners.clickListener = ( $btn: JQuery ): void => {\n            const oldValue: any = this._$input.val();\n            let newVal: any;\n\n            if ( $btn.get( 0 ) === this._$incrementBtn.get( 0 ) ) {\n                newVal = parseFloat( oldValue ) + 1;\n\n                // Don't allow incrementing above maxValue\n                if ( this._maxValue && oldValue < this._maxValue ) {\n                    newVal = parseFloat( oldValue ) + 1;\n                } else if ( this._maxValue && oldValue >= this._maxValue ) {\n                    newVal = this._maxValue;\n                }\n\n            } else {\n\n                // Don't allow decrementing below minValue\n                if ( oldValue > this._minValue ) {\n                    newVal = parseFloat( oldValue ) - 1;\n                } else {\n                    newVal = this._minValue;\n                }\n            }\n\n            this._$input.val( newVal );\n\n            // Run buttons state update function\n            this._updateButtonsState();\n\n            // If previous value of input is different than the one after user click, trigger change event.\n            if ( oldValue !== newVal ) {\n                $( document ).trigger( `.${this._options.namespace}qty-increment:change`, this._$input );\n                this._$input.trigger( 'change' );\n            }\n        };\n\n        this._eventListeners.keydownListener = ( e: KeyboardEvent ): void => {\n            // Allow: backspace, delete, tab, escape, enter and .\n            if ( $.inArray( e.keyCode, [ 46, 8, 9, 27, 13, 110, 190 ] ) !== -1 ||\n\n                // Allow: Ctrl+A\n                ( e.keyCode === 65 && e.ctrlKey === true ) ||\n\n                // Allow: Ctrl+C\n                ( e.keyCode === 67 && e.ctrlKey === true ) ||\n\n                // Allow: Ctrl+X\n                ( e.keyCode === 88 && e.ctrlKey === true ) ||\n\n                // Allow: home, end, left, right\n                ( e.keyCode >= 35 && e.keyCode <= 39 ) ) {\n\n                // Let it happen, don't do anything\n                return;\n            }\n\n            // Ensure that it is a number and stop the keypress\n            if ( ( e.shiftKey || ( e.keyCode < 48 || e.keyCode > 57 ) ) && ( e.keyCode < 96 || e.keyCode > 105 ) ) {\n                e.preventDefault();\n            }\n        };\n\n        this._eventListeners.keyupListener = (): void => {\n            this._validate();\n            this._updateButtonsState();\n        };\n\n        this._eventListeners.blurListener = (): void => {\n            if ( this._$input.val() === '' ) {\n                this._$input.val( this._minValue );\n            }\n            this._updateButtonsState();\n        };\n\n        this._$decrementBtn.on( 'click', function(): void {\n            component._eventListeners.clickListener( $( this ) );\n        } );\n        this._$incrementBtn.on( 'click', function(): void {\n            component._eventListeners.clickListener( $( this ) );\n        } );\n        this._$input.on( 'keydown', this._eventListeners.keydownListener );\n        this._$input.on( 'keyup', this._eventListeners.keyupListener );\n        this._$input.on( 'blur', this._eventListeners.blurListener );\n    }\n}"],"names":[],"mappings":"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"}