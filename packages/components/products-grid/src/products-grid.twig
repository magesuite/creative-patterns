{% set collection = [] %} 
{% set content = '' %}
{% set isHeroIncluded = false %}

{% if items is not defined %}
    {% set items = [] %}
{% endif %}

{% if hero.position is defined and hero.position != '' %}
    {% set isHeroIncluded = true %}
    {% set content %}
        {% if hero.href %}
            <a href="{{ hero.href }}" class="{{ namespace }}products-grid__hero-link">
        {% endif %}

        <figure class="{{ namespace }}products-grid__hero-figure">
            {% if lazyload %}
                <img
                    class="{{ namespace }}products-grid__hero-image | lazyload"
                    src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="
                    data-src="{{ hero_image.src }}"
                    {% if hero_image.srcSet %}data-srcset="{{ hero_image.srcSet }}"{% endif %}
                    {% if sizes %}data-sizes="{{ sizes }}"{% endif %}
                    alt="{% if hero.image.alt %}{{ hero.image.alt }}
                         {% elseif hero.headline %}{{ hero.headline|raw  }}
                         {% elseif hero.subheadline %}{{ hero.subheadline|raw  }}
                         {% else %}Teaser image{% endif %}"
                >
                <noscript>
                    <img
                        class="{{ namespace }}products-grid__hero-image"
                        src="{{ hero.image.src }}"
                        {% if hero.image.srcSet %}srcset="{{ hero.image.srcSet }}"{% endif %}
                        {% if sizes %}sizes="{{ sizes }}"{% endif %}
                        alt="{% if hero.image.alt %}{{ hero.image.alt }}
                            {% elseif hero.headline %}{{ hero.headline|raw  }}
                            {% elseif hero.subheadline %}{{ hero.subheadline|raw  }}
                            {% else %}Teaser image{% endif %}"
                    >
                </noscript>
            {% else %}
                <img
                    class="{{ namespace }}products-grid__hero-image"
                    src="{{ hero.image.src }}"
                    {% if hero.image.srcSet %}srcset="{{ hero.image.srcSet }}"{% endif %}
                    {% if sizes %}sizes="{{ sizes }}"{% endif %}
                    alt="{% if hero.image.alt %}{{ hero.image.alt }}
                        {% elseif hero.headline %}{{ hero.headline|raw  }}
                        {% elseif hero.subheadline %}{{ hero.subheadline|raw  }}
                        {% else %}Teaser image{% endif %}"
                >
            {% endif %}
        </figure>

        <div class="{{ namespace }}products-grid__hero-content-wrapper">
            <div class="{{ namespace }}products-grid__hero-content">
                {% if hero.headline %}
                    <h2 class="{{ namespace }}products-grid__hero-headline">{{ hero.headline|raw }}</h2>
                {% endif %}

                {% if hero.subheadline %}
                    <p class="{{ namespace }}products-grid__hero-subheadline">{{ hero.subheadline|raw }}</p>
                {% endif %}

                {% if hero.paragraph %}
                    <p class="{{ namespace }}products-grid__hero-text">{{ hero.paragraph|raw }}</p>
                {% endif %}

                {% if hero.href and hero.button.label %}
                    <div class="{{ namespace }}products-grid__hero-cta">
                        <span role="button" class="{{ hero.button.class }}">
                            <span class="{{ hero.button.labelClass }}">{{ hero.button.label|striptags }}</span>
                            {% if hero.button.icon.src %}
                                <svg class="{{ hero.button.icon.class }}"><use xlink:href="{{ hero.button.icon.src }}"></use></svg>
                            {% endif %}
                        </span>
                    </div>
                {% endif %}
            </div>
        </div>

        {% if hero.href %}
            </a>
        {% endif %}
    {% endset %}

    {% set collection = collection|merge( [ {
        mix: 'cs-items-grid-layout__item--hero cs-items-grid-layout__item--hero-' ~ hero.position ~ ' | cs-grid-product | cs-products-grid__hero',
        content: content
    } ] ) %}
{% endif %}

{% set collection = collection|merge( items ) %}

<div class="{{ namespace }}products-grid {{ namespace }}products-grid--rows-mobile-{{ rows_mobile }} {{ namespace }}products-grid--rows-tablet-{{ rows_tablet }} {{ namespace }}products-grid--rows-desktop-{{ rows_desktop }} {% if isHeroIncluded %}{{ namespace }}products-grid--with-hero{% endif %}">
    {% include locate('items-grid-layout/items-grid-layout.twig') with {
        namespace: 'cs-',
        items: collection
    } %}
</div>
